# üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É –≠—Ç–∞–ø–∞ 3: –û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏

## –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### Backend
- –ú–æ–¥–µ–ª—å Review —Å –º–æ–¥–µ—Ä–∞—Ü–∏–µ–π
- –°–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–∑—ã–≤–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
- 8 –Ω–æ–≤—ã—Ö API endpoints
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç—ã

### Frontend
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ—Ç–∑—ã–≤–æ–≤ (–∫–∞—Ä—Ç–æ—á–∫–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, —Ñ–æ—Ä–º–∞)
- –°—Ç—Ä–∞–Ω–∏—Ü—ã —Å–æ–∑–¥–∞–Ω–∏—è –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –æ—Ç–∑—ã–≤–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥–µ—Ç–∞–ª—è–º–∏ –∑–∞–∫–∞–∑–∞

## –ó–∞–ø—É—Å–∫

### 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
cd /home/mark/Documents/montaj/backend
npx prisma generate
npx prisma migrate dev --name add_reviews
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã

```bash
cd /home/mark/Documents/montaj
./test-system.sh
```

–ò–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ —Ç–µ—Å—Ç—ã –æ—Ç–∑—ã–≤–æ–≤:

```bash
cd backend
npm test -- review.test.ts
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
cd /home/mark/Documents/montaj
npm run dev
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞

1. –ó–∞–≤–µ—Ä—à–∏—Ç–µ –∑–∞–∫–∞–∑ (—Å—Ç–∞—Ç—É—Å COMPLETED)
2. –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∑–∞–∫–∞–∑–∞ –ø–æ—è–≤–∏—Ç—Å—è –∫–Ω–æ–ø–∫–∞ "–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤"
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∫–Ω–æ–ø–∫–µ
4. –ü–æ—Å—Ç–∞–≤—å—Ç–µ –æ—Ü–µ–Ω–∫—É (1-5 –∑–≤—ë–∑–¥)
5. –ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤)
6. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –æ—Ç–∑—ã–≤

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û—Ç–∑—ã–≤ —Å–æ–∑–¥–∞–Ω —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º PENDING

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–∑—ã–≤–æ–≤

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ö–ª–∏–∫–Ω–∏—Ç–µ "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç–∑—ã–≤—ã" (–µ—Å–ª–∏ –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞)
3. –ò–ª–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/profile/{userId}/reviews`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ –æ–¥–æ–±—Ä–µ–Ω–Ω—ã–µ –æ—Ç–∑—ã–≤—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ú–æ–¥–µ—Ä–∞—Ü–∏—è (–±—É–¥–µ—Ç –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏)

–ü–æ–∫–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ API:

```bash
# –û–¥–æ–±—Ä–∏—Ç—å –æ—Ç–∑—ã–≤
curl -X POST http://localhost:5000/api/reviews/{reviewId}/moderate \
  -H "Authorization: Bearer {admin-token}" \
  -H "Content-Type: application/json" \
  -d '{"action": "approve"}'

# –û—Ç–∫–ª–æ–Ω–∏—Ç—å –æ—Ç–∑—ã–≤
curl -X POST http://localhost:5000/api/reviews/{reviewId}/moderate \
  -H "Authorization: Bearer {admin-token}" \
  -H "Content-Type: application/json" \
  -d '{"action": "reject", "note": "–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è"}'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –†–µ–π—Ç–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è

## –û—Å–Ω–æ–≤–Ω—ã–µ API endpoints

```
POST   /api/reviews                      - –°–æ–∑–¥–∞—Ç—å –æ—Ç–∑—ã–≤
GET    /api/reviews/user/:userId         - –û—Ç–∑—ã–≤—ã –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
GET    /api/reviews/user/:userId/stats   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–∑—ã–≤–æ–≤
GET    /api/reviews/my                   - –ú–æ–∏ –æ—Ç–∑—ã–≤—ã
GET    /api/reviews/:id                  - –û—Ç–∑—ã–≤ –ø–æ ID
GET    /api/reviews/order/:orderId/can-leave  - –ú–æ–∂–Ω–æ –ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤
GET    /api/reviews/pending              - –ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (–∞–¥–º–∏–Ω)
POST   /api/reviews/:id/moderate         - –ú–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å (–∞–¥–º–∏–Ω)
```

## –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞

1. **–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤:**
   - –¢–æ–ª—å–∫–æ –Ω–∞ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã (COMPLETED)
   - –¢–æ–ª—å–∫–æ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –∑–∞–∫–∞–∑–∞
   - –û–¥–∏–Ω –æ—Ç–∑—ã–≤ –Ω–∞ –∑–∞–∫–∞–∑ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ó–∞–∫–∞–∑—á–∏–∫ ‚Üí –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å
   - –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å ‚Üí –ó–∞–∫–∞–∑—á–∏–∫

2. **–ú–æ–¥–µ—Ä–∞—Ü–∏—è:**
   - –í—Å–µ –æ—Ç–∑—ã–≤—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é PENDING
   - –í–∏–¥–Ω—ã –ø—É–±–ª–∏—á–Ω–æ —Ç–æ–ª—å–∫–æ APPROVED
   - –ü—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ä–µ–π—Ç–∏–Ω–≥

3. **–†–µ–π—Ç–∏–Ω–≥–∏:**
   - –ù–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥: 3.0
   - –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏
   - –°—Ä–µ–¥–Ω–∏–π –∏–∑ –≤—Å–µ—Ö –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
backend/
‚îú‚îÄ‚îÄ prisma/schema.prisma           (+ Review model)
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ services/review.service.ts
‚îÇ   ‚îú‚îÄ‚îÄ controllers/review.controller.ts
‚îÇ   ‚îú‚îÄ‚îÄ routes/review.routes.ts
‚îÇ   ‚îî‚îÄ‚îÄ validation/review.validation.ts
‚îî‚îÄ‚îÄ tests/review.test.ts

frontend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ lib/api/reviews.ts
‚îÇ   ‚îú‚îÄ‚îÄ components/reviews/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ReviewCard.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ReviewStats.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ CreateReviewForm.tsx
‚îÇ   ‚îî‚îÄ‚îÄ app/
‚îÇ       ‚îú‚îÄ‚îÄ orders/[id]/review/page.tsx
‚îÇ       ‚îî‚îÄ‚îÄ profile/[userId]/reviews/page.tsx
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

```bash
# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
cd backend
npx prisma migrate reset
npx prisma migrate dev
```

### –¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:
- Docker –∑–∞–ø—É—â–µ–Ω
- PostgreSQL –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 5432
- Redis –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 6379

```bash
docker ps
```

### –û—Ç–∑—ã–≤ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –ó–∞–∫–∞–∑ –≤ —Å—Ç–∞—Ç—É—Å–µ COMPLETED
- –í—ã —É—á–∞—Å—Ç–Ω–∏–∫ –∑–∞–∫–∞–∑–∞
- –û—Ç–∑—ã–≤ –µ—â—ë –Ω–µ –æ—Å—Ç–∞–≤–ª–µ–Ω

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –æ—Ç–∑—ã–≤–æ–≤:
1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª (–∑–∞–∫–∞–∑ ‚Üí –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ ‚Üí –æ—Ç–∑—ã–≤)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–æ–¥–µ—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

–ì–æ—Ç–æ–≤–æ –∫ –≠—Ç–∞–ø—É 4: –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è! üöÄ
