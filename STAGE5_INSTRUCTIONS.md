# üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É –≠—Ç–∞–ø–∞ 5: –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

## ‚úÖ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### Backend
- ‚úÖ –†–æ–ª—å ADMIN –∏ –º–æ–¥–µ–ª—å AdminLog
- ‚úÖ Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- ‚úÖ AdminService - 9 –º–µ—Ç–æ–¥–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ 9 API endpoints –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- ‚úÖ –¢–µ—Å—Ç—ã –∞–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### Frontend
- ‚úÖ API –∫–ª–∏–µ–Ω—Ç –¥–ª—è –∞–¥–º–∏–Ω–∫–∏
- ‚úÖ –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- ‚úÖ –ú–æ–¥–µ—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

## üöÄ –ó–∞–ø—É—Å–∫

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
cd /home/mark/Documents/montaj/backend

# –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
npx prisma migrate dev --name add_admin_panel

# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Prisma Client
npx prisma generate
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**–°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ SQL (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PostgreSQL
psql -U postgres -d montaj

# –°–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
-- –ü–∞—Ä–æ–ª—å –±—É–¥–µ—Ç: admin123
INSERT INTO users (id, phone, password, full_name, city, role, status, is_phone_verified, email)
VALUES (
  gen_random_uuid(),
  '+79999999999',
  '$2b$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LSnLj2JGY.e',
  '–ì–ª–∞–≤–Ω—ã–π –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
  'Moscow',
  'ADMIN',
  'ACTIVE',
  true,
  'admin@montaj.ru'
);
```

**–°–ø–æ—Å–æ–± 2: –ò–∑–º–µ–Ω–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

```bash
psql -U postgres -d montaj

UPDATE users
SET role = 'ADMIN', status = 'ACTIVE'
WHERE phone = '+–≤–∞—à_–Ω–æ–º–µ—Ä_—Ç–µ–ª–µ—Ñ–æ–Ω–∞';
```

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã

```bash
cd /home/mark/Documents/montaj

# –í—Å–µ —Ç–µ—Å—Ç—ã
./test-system.sh

# –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
cd backend
npm test -- admin.test.ts
```

### –®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
cd /home/mark/Documents/montaj

# –ó–∞–ø—É—Å—Ç–∏—Ç—å Docker (–µ—Å–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω)
docker-compose up -d

# –ó–∞–ø—É—Å—Ç–∏—Ç—å backend –∏ frontend
npm run dev
```

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ http://localhost:3000
2. –í–æ–π–¥–∏—Ç–µ —Å —É—á—ë—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
   - –¢–µ–ª–µ—Ñ–æ–Ω: `+79999999999`
   - –ü–∞—Ä–æ–ª—å: `admin123`
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/admin`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í—ã –≤–∏–¥–∏—Ç–µ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

1. –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/admin` –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è 4 –∫–∞—Ä—Ç–æ—á–∫–∏:
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–≤—Å–µ–≥–æ, –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏, –∑–∞–∫–∞–∑—á–∏–∫–∏, –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏)
   - –ó–∞–∫–∞–∑—ã (–≤—Å–µ–≥–æ, –∞–∫—Ç–∏–≤–Ω—ã–µ, –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ)
   - –û—Ç–∑—ã–≤—ã (–≤—Å–µ–≥–æ, –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏)
   - –î–æ—Ö–æ–¥ (–æ–±—â–∏–π, –∑–∞ –º–µ—Å—è—Ü)

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ú–æ–¥–µ—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/admin/users`
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª—å—Ç—Ä "–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏"
3. –£–≤–∏–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º PENDING
4. –ù–∞–∂–º–∏—Ç–µ "–û–¥–æ–±—Ä–∏—Ç—å" —É –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–¥–æ–±—Ä–µ–Ω
- –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ ACTIVE
- –î–µ–π—Å—Ç–≤–∏–µ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–æ

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/admin/reviews`
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª—å—Ç—Ä "–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏"
3. –£–≤–∏–¥–∏—Ç–µ –æ—Ç–∑—ã–≤—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º PENDING
4. –ù–∞–∂–º–∏—Ç–µ "–û–¥–æ–±—Ä–∏—Ç—å" —É –ª—é–±–æ–≥–æ –æ—Ç–∑—ã–≤–∞

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –û—Ç–∑—ã–≤ –æ–¥–æ–±—Ä–µ–Ω
- –†–µ–π—Ç–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω
- –î–µ–π—Å—Ç–≤–∏–µ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–æ

### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/admin/users`
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª—å—Ç—Ä "–ê–∫—Ç–∏–≤–Ω—ã–µ"
3. –ù–∞–∂–º–∏—Ç–µ "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å" —É –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
- –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ BLOCKED
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É

### –°—Ü–µ–Ω–∞—Ä–∏–π 6: –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–∞

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/admin/reviews`
2. –ù–∞–π–¥–∏—Ç–µ –æ—Ç–∑—ã–≤ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
3. –ù–∞–∂–º–∏—Ç–µ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å"
4. –í–≤–µ–¥–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –û—Ç–∑—ã–≤ –æ—Ç–∫–ª–æ–Ω—ë–Ω —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø—Ä–∏—á–∏–Ω–æ–π
- –†–µ–π—Ç–∏–Ω–≥ –ù–ï –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è
- –û—Ç–∑—ã–≤ –Ω–µ –≤–∏–¥–µ–Ω –ø—É–±–ª–∏—á–Ω–æ

## üîß API Endpoints

### –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

```bash
curl http://localhost:5000/api/admin/statistics \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"
```

### –ú–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
# –û–¥–æ–±—Ä–∏—Ç—å
curl -X POST http://localhost:5000/api/admin/users/USER_ID/moderate \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"action": "APPROVE"}'

# –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
curl -X POST http://localhost:5000/api/admin/users/USER_ID/moderate \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"action": "BLOCK", "reason": "–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª"}'
```

### –ú–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–∑—ã–≤

```bash
# –û–¥–æ–±—Ä–∏—Ç—å
curl -X POST http://localhost:5000/api/admin/reviews/REVIEW_ID/moderate \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"action": "APPROVE"}'

# –û—Ç–∫–ª–æ–Ω–∏—Ç—å
curl -X POST http://localhost:5000/api/admin/reviews/REVIEW_ID/moderate \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"action": "REJECT", "note": "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ"}'
```

### –ü–æ–ª—É—á–∏—Ç—å –ª–æ–≥–∏

```bash
curl http://localhost:5000/api/admin/logs?page=1&limit=50 \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"
```

## üìä –§—É–Ω–∫—Ü–∏–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- ‚úÖ APPROVE - –æ–¥–æ–±—Ä–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é (PENDING ‚Üí ACTIVE)
- ‚úÖ REJECT - –æ—Ç–∫–ª–æ–Ω–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é (PENDING ‚Üí REJECTED)
- ‚úÖ BLOCK - –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (ACTIVE ‚Üí BLOCKED)
- ‚úÖ UNBLOCK - —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å (BLOCKED ‚Üí ACTIVE)

**–§–∏–ª—å—Ç—Ä—ã:**
- –ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (PENDING)
- –ê–∫—Ç–∏–≤–Ω—ã–µ (ACTIVE)
- –û—Ç–∫–ª–æ–Ω—ë–Ω–Ω—ã–µ (REJECTED)
- –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ (BLOCKED)
- –í—Å–µ

### –ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- ‚úÖ APPROVE - –æ–¥–æ–±—Ä–∏—Ç—å –æ—Ç–∑—ã–≤ + –ø–µ—Ä–µ—Å—á—ë—Ç —Ä–µ–π—Ç–∏–Ω–≥–∞
- ‚úÖ REJECT - –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –æ—Ç–∑—ã–≤ (—Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–∏—á–∏–Ω–æ–π)

**–§–∏–ª—å—Ç—Ä—ã:**
- –ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (PENDING)
- –û–¥–æ–±—Ä–µ–Ω–Ω—ã–µ (APPROVED)
- –û—Ç–∫–ª–æ–Ω—ë–Ω–Ω—ã–µ (REJECTED)
- –í—Å–µ

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Å—á—ë—Ç —Ä–µ–π—Ç–∏–Ω–≥–∞:**
- –ü—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –æ—Ç–∑—ã–≤–∞
- –£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ APPROVED –æ—Ç–∑—ã–≤—ã
- –°—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ –≤—Å–µ—Ö –æ—Ü–µ–Ω–æ–∫

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–ú–µ—Ç—Ä–∏–∫–∏:**
- üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: –≤—Å–µ–≥–æ, –ø–æ —Ä–æ–ª—è–º, –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
- üì¶ –ó–∞–∫–∞–∑—ã: –≤—Å–µ–≥–æ, –∞–∫—Ç–∏–≤–Ω—ã–µ, –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ
- ‚≠ê –û—Ç–∑—ã–≤—ã: –≤—Å–µ–≥–æ, –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
- üí∞ –î–æ—Ö–æ–¥: –æ–±—â–∏–π, –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü

### –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π

**–ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è:**
- –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏
- ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –¢–∏–ø –¥–µ–π—Å—Ç–≤–∏—è (APPROVE, REJECT, BLOCK, UNBLOCK)
- –¶–µ–ª–µ–≤–æ–π –æ–±—ä–µ–∫—Ç (USER, ORDER, REVIEW)
- –ü—Ä–∏—á–∏–Ω–∞ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞)
- –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (—Å—Ç–∞—Ä—ã–π/–Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å –∏ —Ç.–¥.)

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** Prisma 7 —Ç—Ä–µ–±—É–µ—Ç –¥—Ä—É–≥–æ–π —Ñ–æ—Ä–º–∞—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```bash
cd backend
npm install prisma@6 @prisma/client@6
npx prisma migrate dev
```

### –ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å–æ–∑–¥–∞–Ω –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ
SELECT * FROM users WHERE role = 'ADMIN';

-- –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –∞–¥–º–∏–Ω–∞ (—Å–º. –®–∞–≥ 2)
```

### –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç —Ä–æ–ª–∏ ADMIN

**–†–µ—à–µ–Ω–∏–µ:**
```sql
UPDATE users
SET role = 'ADMIN'
WHERE id = '–≤–∞—à-user-id';
```

### –¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–î –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞ –∏–ª–∏ –Ω–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
```bash
docker-compose up -d
cd backend
npx prisma migrate dev
npm test
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- ‚úÖ JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ ADMIN
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ ACTIVE
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å:

1. **Rate limiting:**
```typescript
const adminLimiter = rateLimit({
  windowMs: 15 * 60 * 1000,
  max: 100,
});
```

2. **IP whitelist:**
```typescript
const ADMIN_IPS = ['1.2.3.4'];
// –ü—Ä–æ–≤–µ—Ä—è—Ç—å req.ip
```

3. **2FA (–¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)**

4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π logout —á–µ—Ä–µ–∑ N –º–∏–Ω—É—Ç**

## üìö –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
backend/
‚îú‚îÄ‚îÄ prisma/schema.prisma           (+ AdminLog model)
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ middleware/admin.middleware.ts
‚îÇ   ‚îú‚îÄ‚îÄ services/admin.service.ts
‚îÇ   ‚îú‚îÄ‚îÄ controllers/admin.controller.ts
‚îÇ   ‚îú‚îÄ‚îÄ routes/admin.routes.ts
‚îÇ   ‚îî‚îÄ‚îÄ validation/admin.validation.ts
‚îî‚îÄ‚îÄ tests/admin.test.ts

frontend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ lib/api/admin.ts
‚îÇ   ‚îú‚îÄ‚îÄ components/admin/StatisticsCards.tsx
‚îÇ   ‚îî‚îÄ‚îÄ app/
‚îÇ       ‚îî‚îÄ‚îÄ admin/
‚îÇ           ‚îú‚îÄ‚îÄ page.tsx           (–≥–ª–∞–≤–Ω–∞—è)
‚îÇ           ‚îú‚îÄ‚îÄ users/page.tsx     (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
‚îÇ           ‚îî‚îÄ‚îÄ reviews/page.tsx   (–æ—Ç–∑—ã–≤—ã)
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏:

1. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –ë–î
3. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
4. ‚úÖ –°–æ–∑–¥–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

**–ì–æ—Ç–æ–≤–æ –∫ –≠—Ç–∞–ø—É 6: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!** üöÄ

---

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–î
cd backend
npx prisma studio

# –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
psql -U postgres -d montaj -c "SELECT * FROM admin_logs ORDER BY created_at DESC LIMIT 10"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
psql -U postgres -d montaj -c "SELECT * FROM users WHERE role = 'ADMIN'"

# –°–¥–µ–ª–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
psql -U postgres -d montaj -c "UPDATE users SET role='ADMIN' WHERE phone='+–≤–∞—à_–Ω–æ–º–µ—Ä'"
```
